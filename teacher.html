<!DOCTYPE html><html lang="ja"><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1"><title>Authテスト</title>
<body><h2>Googleログインテスト</h2><div id="auth"></div>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signInWithPopup, signInWithRedirect, GoogleAuthProvider, signOut } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

const firebaseConfig = { /apiKey: "AIzaSyBzRI3ReUylTAyRhUusWiSyShUMA-mqfAw",
  authDomain: "web1-fc8d7.firebaseapp.com",
  projectId: "web1-fc8d7",
  storageBucket: "web1-fc8d7.firebasestorage.app",
  messagingSenderId: "186079003085",
  appId: "1:186079003085:web:b4bfb7a359017366e70484",
  measurementId: "G-HHSR5ZTG15/ };
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const $ = s=>document.querySelector(s);

function showLogin(){
  document.getElementById('auth').innerHTML =
    `<button id="gin">Googleでサインイン</button>`;
  document.getElementById('gin').onclick = async ()=>{
    try { await signInWithPopup(auth, new GoogleAuthProvider()); }
    catch (e) {
      // ポップアップがブロックされたらリダイレクトで再挑戦
      await signInWithRedirect(auth, new GoogleAuthProvider());
    }
  };
}

onAuthStateChanged(auth, u=>{
  if(!u) { showLogin(); }
  else {
    document.getElementById('auth').innerHTML =
      `${u.email} <button id="out">サインアウト</button>`;
    document.getElementById('out').onclick = ()=>signOut(auth);
  }
});
</script></body></html>
